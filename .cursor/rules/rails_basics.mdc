---
description: Travel Diary App - Stack Técnico y Convenciones Base
globs: "**/*"
alwaysApply: true
---

## Stack Tecnológico
- Ruby on Rails 8
- Ruby 3.2+
- PostgreSQL como base de datos
- Hotwire (Turbo + Stimulus) para interactividad sin JavaScript pesado
- TailwindCSS 3 para estilos
- ActiveStorage para gestión de archivos (billetes de avión)
- ViewComponent para componentes reutilizables

## Gemas Principales
- devise o rails authentication para login básico
- omniauth-google-oauth2 para login con Google
- omniauth-apple para login con Apple ID
- image_processing para procesamiento de imágenes de billetes
- aws-sdk-s3 o similar para almacenamiento cloud (producción)

## Convenciones de Código
- **Idioma**: Código en inglés (variables, métodos, clases). Mensajes al usuario en español.
- **Controladores**: Mantenerlos delgados, máximo 5-7 líneas por acción
- **Service Objects**: Crear en `app/services/` para lógica de negocio compleja
- **Helpers**: Solo para vistas, evitar lógica de negocio
- **Validaciones**: En modelos, usar validaciones personalizadas en `app/validators/`

## Estructura de Carpetas Adicionales
app/
├── services/ # Lógica de negocio (ParseTicketService, etc.)
├── uploaders/ # Lógica de subida de archivos
├── presenters/ # Para formatear datos en vistas
└── components/ # ViewComponents reutilizables

## Preferencias de Código
- Usar sintaxis moderna de Ruby (keyword arguments, pattern matching)
- Preferir `#presence` sobre `present?`
- Usar `#fetch` sobre `[]` para hashes cuando esperamos claves
- Turbo Streams sobre JavaScript cuando sea posible
- Stimulus controllers para interactividad específica
- Preferir consultas ActiveRecord sobre SQL raw

## Testing
- RSpec para tests
- FactoryBot para fixtures
- Shoulda Matchers para validaciones
- VCR para tests con APIs externas

## Respuestas JSON
- Usar JBuilder para vistas JSON complejas
- Seguir convenciones REST
- Incluir siempre metadata (timestamps, versión)
